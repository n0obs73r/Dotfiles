function openWindow(n,t,i,r){var u=n+10,f=t+28,e=Math.round(screen.width/2-u/2),o=Math.round(screen.height/2-f/2);chrome.windows.create({url:i,type:"popup",width:u,height:f,left:e,top:o,focused:!0},function(n){addListner(n.id,r);var t=n.tabs[0].id;chrome.tabs.insertCSS(t,{runAt:"document_start",code:"::-webkit-scrollbar{width:9px!important;height:9px!important}::-webkit-scrollbar-button:start:decrement,::-webkit-scrollbar-button:end:increment{height:0;width:0;display:none}::-webkit-scrollbar-track-piece{margin:1px;padding:0;width:6px!important;height:5px!important;background:rgba(255,255,255,0.3)}::-webkit-scrollbar:hover{background:rgba(128,128,128,0.2)}::-webkit-scrollbar-thumb{margin:1px!important;border:2px solid transparent;width:5px!important;background-color:rgba(0,0,0,0.4)!important;z-index:9999;-webkit-border-radius:12px;background-clip:content-box}::-webkit-scrollbar-corner{background:rgba(255,255,255,0.3);border:1px solid transparent}::-webkit-scrollbar-thumb:hover{background-color:rgba(0,0,0,0.8)!important;border:2px solid transparent}::-webkit-scrollbar-thumb:active{background-color:rgba(0,0,0,0.6)!important;border:2px solid transparent}"})})}function addListner(n,t){handler=function(n){for(var i=0,r=n.requestHeaders.length;i<r;++i)if(n.requestHeaders[i].name==="User-Agent"){n.requestHeaders[i].value=t;break}return{requestHeaders:n.requestHeaders}};chrome.webRequest.onBeforeSendHeaders.addListener(handler,{urls:["<all_urls>"],windowId:n},["blocking","requestHeaders"])}function runAppStart(){var n=localStorage.rwdStore;userAgents=n!=undefined?JSON.parse(n):JSON_UserAgentsList;localStorage.rwdStore=JSON.stringify(userAgents);createContextMenu()}function createContextMenu(){chrome.contextMenus.removeAll();userAgents.forEach(function(n){if(n.UserAgents.length!=0)var t=chrome.contextMenus.create({id:n.Id,contexts:["all"],title:n.Name,type:"normal"}),i=n.UserAgents.forEach(function(t){chrome.contextMenus.create({id:t.Id,parentId:n.Id,contexts:["all"],onclick:function(){setUserAgent(t.Id,"ContextMenu")},title:t.Name,type:"normal"})})});chrome.contextMenus.create({contexts:["all"],type:"separator"});chrome.contextMenus.create({contexts:["all"],onclick:function(){return chrome.tabs.create({url:"options.html"}),!1},title:"Options",type:"normal"});chrome.contextMenus.create({contexts:["all"],onclick:function(){return chrome.tabs.create({url:"http://www.esolutions.se/en-GB/test"}),!1},title:"Test page",type:"normal"})}function setUserAgent(n,t,i){var r="";chrome.tabs.query({active:!0,currentWindow:!0},function(t){var i,u;for(r=t[0].url,i=0;i<userAgents.length;i++)for(u=0;u<userAgents[i].UserAgents.length;u++)if(userAgents[i].UserAgents[u].Id==n){openWindow(userAgents[i].UserAgents[u].Width,userAgents[i].UserAgents[u].Height,r,userAgents[i].UserAgents[u].UserAgent);break}});i&&typeof i=="function"&&i()}var userAgents=JSON_UserAgentsList;runAppStart();